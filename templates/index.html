
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Fish Freshness Analyzer - Web</title>
  <link rel="stylesheet" href="/static/styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <div class="app">
    <header class="header">
      <div class="title-container">
        <a href="/" class="title-link">
          <div class="title"><i class="fas fa-fish"></i> Fish Freshness Analyzer</div>
        </a>
        <div class="sub">Developed by <a href="https://www.atb-potsdam.de/en/about-us/areas-of-competence/systems-process-engineering/storage-and-packaging" target="_blank">PACK Group, ATB Potsdam, Germany</a></div>
      </div>
      <div class="logo"><a href="https://novishpak.eu/" target="_blank">NOVISHPAK</a></div>
    </header>

    <main class="main-grid">
      <section class="left-panel card">
        <h3 class="section-title"><i class="fas fa-camera"></i> Image Acquisition</h3>

        <div class="controls">
          <div class="input-group">
            <label><i class="fas fa-vial"></i> TVB-N limit (mg/100g)</label>
            <input id="tvbn" type="number" value="30" step="0.1" min="0" max="100">
          </div>

          <div class="input-group">
            <label><i class="fas fa-weight-hanging"></i> Fish mass (g)</label>
            <input id="mass" type="number" value="250" step="0.1" min="1">
          </div>

          <div class="input-group">
            <label><i class="fas fa-box-open"></i> Package Volume (L)</label>
            <input id="headspace" type="number" value="0.5" step="0.01" min="0" max="2">
          </div>

          <div class="input-group">
            <label><i class="fas fa-temperature-low"></i> Temperature (°C)</label>
            <input id="temp" type="number" value="4" step="0.1" min="0" max="35">
          </div>

          <div class="button-group">
            <button id="openFile" class="btn"><i class="fas fa-folder-open"></i> Load Image</button>
            <button id="startCam" class="btn"><i class="fas fa-camera"></i> Toggle Camera</button>
            <button id="captureBtn" class="btn" disabled><i class="fas fa-camera-retro"></i> Capture</button>
          </div>

          <input id="fileInput" accept="image/*" type="file" style="display:none">

          <div class="warning" id="warning"></div>
        </div>

        <div class="camera card" id="cameraBox" style="display:none;">
          <video id="video" autoplay playsinline muted></video>
          <canvas id="hiddenCanvas" style="display:none"></canvas>
        </div>
      </section>

      <section class="right-panel">
        <div class="card results-section">
          <h3 class="section-title"><i class="fas fa-chart-line"></i> Analysis</h3>

          <div class="images-row">
            <div class="image-block">
              <div class="label">Original</div>
              <div class="image-container">
                <img id="img_original"/>
              </div>
            </div>
            <div class="image-block">
              <div class="label">Black Reference</div>
              <div class="image-container">
                <img id="img_black"/>
              </div>
            </div>
            <div class="image-block">
              <div class="label">White Reference</div>
              <div class="image-container">
                <img id="img_white"/>
              </div>
            </div>
            <div class="image-block">
              <div class="label">Fish Patch</div>
              <div class="image-container">
                <img id="img_target"/>
              </div>
            </div>
          </div>
          
          <div class="action-row" style="margin-top: 20px;">
            <button id="recropBtn" class="btn"><i class="fas fa-crop-alt"></i> Recrop the image</button>
          </div>
        </div>

        <div class="warnings-container card" id="analysisWarnings" style="display: none;"></div>

        <div class="card results-section">
          <h4 class="result-title"><i class="fas fa-palette"></i> Reference Values</h4>
          <div class="result-item">
            <pre id="rgb_label"></pre>
          </div>
          <div class="result-item">
            <pre id="hsv_label"></pre>
          </div>
          <div class="result-item">
            <pre id="chroma_label"></pre>
          </div>
          <div class="result-item">
            <pre id="hue_label"></pre>
          </div>
        </div>

        <div class="card results-section">
          <h4 class="result-title"><i class="fas fa-adjust"></i> Corrected Values</h4>
          <div class="result-item">
            <pre id="corrected_rgb_label"></pre>
          </div>
          <div class="result-item">
            <pre id="corrected_v_label"></pre>
          </div>
          <div class="result-item">
            <pre id="corrected_chroma_label"></pre>
          </div>
          <div class="result-item">
            <pre id="corrected_hue_label"></pre>
          </div>
        </div>

        <div class="card results-section">
          <h4 class="result-title"><i class="fas fa-flask"></i> Freshness Parameters</h4>
          <div class="result-item">
            <pre id="ph_label"></pre>
          </div>
          <div class="result-item">
            <pre id="tvbn_label"></pre>
          </div>
          <div class="result-item">
            <pre id="ammonia_label"></pre>
          </div>
          <div class="result-item">
            <pre id="shelf_life_label"></pre>
          </div>
        </div>

        <div class="card results-section">
          <div class="action-row">
            <button id="savePdf" class="btn"><i class="fas fa-file-pdf"></i> Save Analysis (PDF)</button>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div class="footer-content">
        <span>© 2025 All rights reserved · Sample model · PRIMA</span>
        <span class="version">v1.0.0</span>
      </div>
    </footer>
  </div>

  <div id="cropModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="fas fa-crop-alt"></i> Crop Image</h3>
        <span class="close">&times;</span>
      </div>
      <div class="modal-body">
        <div class="crop-instructions">
          <p>Drag to select the area containing all three color patches, or click "Use Entire Image" to proceed without cropping.</p>
          <p>The analyzer will automatically detect the black, white, and fish patch regions.</p>
        </div>
        <div class="crop-container">
          <canvas id="cropCanvas"></canvas>
        </div>
        <div class="button-group">
          <button id="useCrop" class="btn success"><i class="fas fa-check"></i> Use Selected Area</button>
          <button id="useFullImage" class="btn success"><i class="fas fa-image"></i> Use Entire Image</button>
          <button id="resetCrop" class="btn ghost"><i class="fas fa-undo"></i> Reset Selection</button>
        </div>
      </div>
    </div>
  </div>

  <script src="/static/app.js"></script>
</body>
</html>